[phases.setup]
packages = ["php", "php-mbstring", "php-bcmath", "php-curl", "php-mysql", "composer", "nodejs", "npm", "git"]

[phases.install]
commands = [
  "composer install --no-dev --optimize-autoloader",
  "npm install"
]

[phases.build]
commands = [
  "npm run build",
  "php artisan migrate --force"
]

[phases.start]
# Remove artisan serve; Railway/Nixpacks will serve via Apache/Nginx
command = "apache2-foreground"

[env]
PORT = "8080"
APP_ENV = "production"
APP_DEBUG = "false"
APP_URL = "https://plexus-medical-city-production.up.railway.app"
